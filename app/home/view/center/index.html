<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>个人中心</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <meta HTTP-EQUIV="Expires" CONTENT="-1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <link rel="shortcut icon" href="__IMG__/favicon.ico" />
    <link rel="bookmark" href="__IMG__/favicon.ico" type="image/x-icon"　/>
    <link rel="stylesheet" type="text/css" href="__CSS__/style.css"/>
    <link rel="stylesheet" type="text/css" href="__CSS__/skin.css"/>
    <link rel="stylesheet" type="text/css" href="__CSS__/common.css"/>
    <link rel="stylesheet" href="__CSS__/index.css">
    <link type="text/css" rel="stylesheet" href="__CSS__/chat-index.css">
    <link rel="stylesheet" type="text/css" href="__CSS__/index-index-inde.css"/>
    <link rel="stylesheet" type="text/css" href="__CSS__/index_sy.css"/>
    <script src="__JS__/jquery-1.7.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="__JS__/jquery.validate.min.js"></script>
    <script src="__JS__/layer.js" ></script>
    <script src="__JS__/common.js" ></script>
    <style type="text/css">
        .subnaviarrow,.recharge_div,.subcontent,.addbankcard_form{display: none;}
        .subnaviarrow.active,.recharge_div.active,.subcontent.active{display: block;}
        .records_ul li{
            float: left;
            width: 25%;
            margin: 0 3%;
            border: 1px solid #D3D1D1;
            border-radius: 5px;
            padding: 10px;
        }
        .records_choose span{
            padding: 10px;
        }
        .records_choose select,.records_choose input{
            width: 300px;
            border-radius:5px ;
            border: 1px solid #D3D1D1;
            padding: 10px 5px;
        }
        .records_choose label{width: 70px;}
        .header .lotterys .show>a{height: 37px;line-height: 37px;}
        .header .menu2{left: 705px;}
        .logo2 {left: 0; }
        .info span{display: inline;}
        input[type="number"]{-moz-appearance:textfield;}
        input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance: none !important;}
    </style>
</head>
<body>
<div id="appLoading" class="bet-loading" style="position: fixed; width: 100%; top: 200px; text-align: center; z-index: 3000; display: none;">
    <div class="spinner">
        <div class="three-bounce">
            <div class="one"></div>
            <div class="two">

            </div>
            <div class="three"></div>
        </div>
    </div>
</div>
<div class="main-body skin_red" style="right: 0px;">
    {include file="common/index_top" /}
    <div class="main-wrap"><!---->
        {include file="common/index_siderbar" /}
        <div class="content-wrap" style="width: 1000px;border: 1px solid #D2D2D2;">
            <div class="content">
                <div class="sub-wrap clearfix">
                    <div class="center-page">
                        <div class="memberheader">
                            <div class="useravatar floatleft">
                                <img src="__IMG__/userlogo.jpg" width="84" height="83" alt="">
                            </div>
                            <div class="memberinfo floatleft">
                                <h1 class="floatleft">您好, <span id="userName" class="blue">{$memInfo.name}</span></h1>
                                <!--<div class="balance floatleft">-->
                                    <!--<div class="balancevalue floatleft">-->
                                        <!--中心钱包 : <span class="blue"><span class="balanceCount">0</span> 元</span>-->
                                    <!--</div>-->
                                    <!--<div class="floatright margintop7 marginright10 marginleft5 pointer">-->
                                        <!--<a href="javascript:;"><img src="__IMG__/btnrefresh.jpg" width="16" height="17" alt=""></a>-->
                                    <!--</div>-->
                                <!--</div>-->
                                <div class="gap5"></div>
                                <p>彩票网投领导者·实力铸就品牌·诚信打造一切·相信品牌的力量</p>
                                <!--<p>最后登录：<span id="loginTime">2018-01-23 09:38:14</span></p>-->
                            </div>
                        </div>
                        <div class="membersubnavi">
                            <div class="subnavi blue">
                                <a href="javascript:void(0)">额度转换</a>
                                <div class="subnaviarrow active" >
                                </div>
                            </div>
                            <div class="subnavi blue">
                                <a href="javascript:void(0)">密码设置</a>
                                <div class="subnaviarrow" ></div>
                            </div>
                            <div class="subnavi blue">
                                <a href="javascript:void(0)">资金密码</a>
                                <div class="subnaviarrow "></div>
                            </div>
                        </div>
                        <div class="recharge_div active">
                            <form id="changeMoneyForm" action="{:url('changeMoney')}">
                                <div class="records margintop20">
                                <h4 class="h4 padding_10 bor_b">钱包中心</h4>
                                <ul class="clearfix records_ul mg_top40">
                                    <li>钱包余额：<span class="red1">{$memMoney.money}</span></li>
                                    <li>AG余额：<span class="red1">{$memMoney.ag_money}</span></li>
                                    <li>SS余额：<span class="red1">{$memMoney.bb_money}</span></li>
                                </ul>
                                <h4 class="h4 padding_10 bor_b mg_top40">游戏平台转账</h4>
                                <div class="records_choose">
								    	<span>
								    		<label for="">转账从：</label>
								    		<select name="type" id="moneySel">
								    			<option value="1">钱包余额</option>
								    			<option value="2">AG余额</option>
								    			<option value="3">SS余额</option>
								    		</select>
								    	</span>
                                        <span>
								    		<label for="">转账到：</label>
								    		<select name="typeSec" id="moneySelSec">
								    			<option value="2">AG余额</option>
								    			<option value="3">SS余额</option>
								    		</select>
								    	</span>
                                </div>
                                <div class="records_choose">
								       	<span>
									    	<label for="">转账金额：</label>
									    	<input type="number" name="money" value="" maxlength="6" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" />
								    	</span>
                                </div>
                                <div class="records_choose">
								    	<span>
									    	<label for="">资金密码：</label>
									    	<input type="password" name="money_password" value="" />
								    	</span>
                                </div>
                                <p><input type="button" name="" id="changeMoney" value="提交" class="btn marginleft30" /></p>
                            </div>
                            </form>
                        </div>
                        <div class="recharge_div">
                            <div class="subcontent1 margintop20">
                                <form class="el-form formpanel margintop20" id="resetLoginPass"><!---->
                                    <div class="el-form-item wd-row is-required"><!---->
                                        <div class="el-form-item__content">
                                            <div class="wd-col1">当前密码：</div>
                                            <div class="wd-col2"><input type="password" name="oldpassword" class="textfield1"></div><!---->
                                        </div>
                                    </div>
                                    <div class="el-form-item wd-row is-required"><!---->
                                        <div class="el-form-item__content">
                                            <div class="wd-col1">新密码：</div>
                                            <div class="wd-col2"><input type="password" name="password" class="textfield1"></div><!---->
                                        </div>
                                    </div>
                                    <div class="el-form-item wd-row is-required"><!---->
                                        <div class="el-form-item__content">
                                            <div class="wd-col1">确认密码：</div>
                                            <div class="wd-col2">
                                                <input type="password" name="repassword" class="textfield1"></div><!---->
                                        </div>
                                    </div>
                                    <div class="wd-row" style="text-align: center;">
                                        <div><input type="button" id="subLogin" value="提交" class="c-button"></div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="recharge_div">
                            <div class="subcontent1 margintop20">
                                <form class="el-form formpanel margintop20" id="setMoneyPass">
                                    <div class="el-form-item wd-row is-required" id="oldMoneyPass">
                                        <div class="el-form-item__content">
                                            <div class="wd-col1">当前资金密码：</div>
                                            <div class="wd-col2"><input type="password" name="oldpassword" class="textfield1"></div><!---->
                                        </div>
                                    </div>
                                    <div class="el-form-item wd-row is-required"><!---->
                                        <div class="el-form-item__content">
                                            <div class="wd-col1">资金密码：</div>
                                            <div class="wd-col2"><input type="password" name="newpassword" class="textfield1"></div><!---->
                                        </div>
                                    </div>
                                    <div class="el-form-item wd-row is-required">
                                        <div class="el-form-item__content">
                                            <div class="wd-col1">重复密码：</div>
                                            <div class="wd-col2">
                                                <input type="password" name="renewpassword" class="textfield1"></div>
                                        </div>
                                    </div>
                                    <div class="wd-row" style="text-align: center;">
                                        <div><input type="button" id="subSetMoney" value="提交" class="c-button"></div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="cont-sider"><!----></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(".membersubnavi .subnavi ").click(function(){
        var index =$(this).index();
        $(this).children(".subnaviarrow").addClass("active");
        $(this).siblings().children(".subnaviarrow").removeClass("active");
        $(".recharge_div").eq(index).addClass("active").siblings().removeClass("active");
    })
    $(".tabs .tab").click(function(){
        var index =$(this).index()-1;
        $(this).addClass("tabactive").siblings().removeClass("tabactive");
        $(".subcontent").eq(index).addClass("active").siblings().removeClass("active");
    })
    $(".addbankcard_img").click(function(){
        $(".addbankcard_form").show();
        $(".addbankcard").hide();
    })
    $(".lottery_box_one").hover(function(){
        $("#lottery_list").fadeIn(200);
    },function(){
        $("#lottery_list").fadeOut(200);
    })
    $(".agent").hover(function(){
        $("#agent_list").fadeIn(200);
    },function(){
        $("#agent_list").fadeOut(200);
    })
    function checkMoneyPass(){
        $.ajax({
            url: "{:url('checkMoneyPass')}",
            data:{type:1},
            type: 'POST',
            dataType: "json",
            success: function (data) {
                if(data.code == 0){
                    $(".membersubnavi .subnavi:eq(2)").click();
                    $('#oldMoneyPass').css('display','none');
                    pop(data.msg);
                }else{
                    $('#oldMoneyPass').css('display','block');
                }
            }
        });
    }
    $(".membersubnavi .subnavi:eq(0)").click(function(){
        checkMoneyPass();
    });
    $(function(){
        setTimeout(function(){
            checkMoneyPass();
        },1000);
        $('#moneySel').change(function(){
            var str = '';
            var val = $(this).val();
            switch (val){
                case '2':
                    str += '<option value="1">钱包余额</option>';
                    break;
                case '3':
                    str += '<option value="1">钱包余额</option>';
                    break;
                default:
                    str += '<option value="2">AG余额</option>';
                    str += '<option value="3">SS余额</option>';
                    break;
            }
            $('#moneySelSec').html(str);
        });
        var subCheck = true;
        $("#changeMoney").click(function(){
            $('#changeMoneyForm').serialize();
            var self = $('#changeMoneyForm'),
                rules = {
                    type : {
                        required : true
                    },
                    typeSec : {
                        required : true
                    },
                    money_password : {
                        required : true,
                        rangelength : [6,6],
                        stringCheck : true
                    },
                    money : {
                        required : true,
                        isIntAndGtZero : true
                    }
                },
                messages = {
                    type : {
                        required : '请选择转账类型'
                    },
                    typeSec : {
                        required : '请选择转账类型'
                    },
                    money_password : {
                        required : '请输入资金密码',
                        rangelength : '密码长度6位数'
                    },
                    money : {
                        required : '请输入金额',
                        isIntAndGtZero : '输入金额格式不正确'
                    }
                };
            if(!check_validate(self,rules,messages).form()){
                return false;
            }
            if(subCheck) {
                subCheck = false;
                $.ajax({
                    url:"{:url('changeMoney')}",
                    type: "POST",
                    data:self.serialize(),
                    success : function(data) {
                        if (data.code == 1) {
                            pop(data.msg,data.url,3);
                        } else {
                            pop(data.msg);
                            subCheck = true;
                        }
                    },
                    error: function() {
                        //warningMessage("查询失败")
                    },
                    beforeSend: function() {
                        index = layer.load(0, {shade: [0.5, '#393D49']});
                        //$('#reportList').html('<tr><td colspan="13"><img src="/static/home/img/803.gif"><br>正在查询</td></tr>');
                    },
                    complete: function() {
                        layer.close(index);
                    }
                })
            }
        });
        var subSetMoneyCheck = true;
        $('#subSetMoney').click(function () {
            var self = $('#setMoneyPass');
            if($('#id').css('display') == 'none'){
                var rules = {
                    newpassword : {
                        required : true,
                        rangelength : [6,6],
                        stringCheck : true
                    },
                    renewpassword : {
                        required : true,
                        rangelength : [6,6],
                        equalTo : '#setMoneyPass input[name=password]'
                    }
                };
            }else{
                var rules = {
                    oldpassword : {
                        required : true,
                        rangelength : [6,6],
                        stringCheck : true
                    },
                    newpassword : {
                        required : true,
                        rangelength : [6,6],
                        stringCheck : true
                    },
                    renewpassword : {
                        required : true,
                        rangelength : [6,6],
                        equalTo : '#setMoneyPass input[name=newpassword]'
                    }
                };
            }
            var messages = {
                oldpassword : {
                    required : '请输入原始资金密码',
                    rangelength : '密码长度需要6位',
                    stringCheck : '密码只能包含英文、数字、下划线'
                },
                newpassword : {
                    required : '请输入密码',
                    rangelength : '密码长度需要6位',
                    stringCheck : '密码只能包含英文、数字、下划线'
                },
                renewpassword : {
                    required : '两次密码输入不一致',
                    rangelength : '两次密码输入不一致',
                    equalTo : '两次密码输入不一致'
                }
            };
            if(!check_validate(self,rules,messages).form()){
                return false;
            }
            if(subSetMoneyCheck) {
                subSetMoneyCheck = false;
                $.post("{:url('subMoneyReset')}", self.serialize(), success, "json");
                return false;
                function success(data) {
                    if (data.code == 1) {
                        pop(data.msg);
                        self[0].reset();
                    } else {
                        pop(data.msg);
                    }
                    subSetMoneyCheck = true;
                }
            }
        })
        var subLoginCheck = true;
        $("#subLogin").click(function(){
            $('#resetLoginPass').serialize();
            var self = $('#resetLoginPass'),
                rules = {
                    oldpassword : {
                        required : true,
                        rangelength : [6,12],
                        stringCheck : true
                    },
                    password : {
                        required : true,
                        rangelength : [6,12],
                        stringCheck : true
                    },
                    repassword : {
                        required : true,
                        rangelength : [6,12],
                        equalTo : '#resetLoginPass input[name=password]'
                    }
                },
                messages = {
                    oldpassword : {
                        required : '请输入原始密码',
                        rangelength : '密码长度6到12之间',
                        stringCheck : '密码只能包含英文、数字、下划线'
                    },
                    password : {
                        required : '请输入密码',
                        rangelength : '密码长度6到12之间',
                        stringCheck : '密码只能包含英文、数字、下划线'
                    },
                    repassword : {
                        required : '两次密码输入不一致',
                        rangelength : '两次密码输入不一致',
                        equalTo : '两次密码输入不一致'
                    }
                };
            if(!check_validate(self,rules,messages).form()){
                return false;
            }
            if(subLoginCheck) {
                subLoginCheck = false;
                $.post("{:url('subLoginReset')}", self.serialize(), success, "json");
                return false;
                function success(data) {
                    if (data.code == 1) {
                        pop(data.msg);
                        self[0].reset();
                    } else {
                        pop(data.msg);
                    }
                    subLoginCheck = true;
                }
            }
        })
    });

</script>
</body>
</html>
